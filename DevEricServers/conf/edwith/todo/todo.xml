<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="todo">
	<typeAlias alias="todoDto" type="edwith.todo.vo.TodoDto"/>
	<select id="getTodos" resultClass="edwith.todo.vo.TodoDto">
		select id, title, name, sequence, type, regdate from todo order by regdate desc;
	</select>
	<update id="todoUpdateDoing" parameterClass="Long">
		update todo 
		set type = 'DOING' 
		where id = #id#;
	</update>
	<update id="todoUpdateDone" parameterClass="Long">
		update todo 
		set type = 'DONE' 
		where id = #id#;
	</update>
	<update id="todoUpdate" parameterClass="Long">
		update todo
		set type = (case
					when (select type from todo where id = #id#) = 'TODO'
					then 'DOING'
					when (select type from todo where id = #id#) = 'DOING'
					then 'DONE'
					end)
		where id = #id#
	</update>
</sqlMap>	






